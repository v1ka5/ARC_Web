(function(){if(!window.cmsInitialized){function i(){document.readyState==="complete"?setTimeout(t):document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):(document.attachEvent("onreadystatechange",n),window.attachEvent("onload",n))}function n(n){(document.addEventListener||n.type==="load"||document.readyState==="complete")&&(r(),t())}function r(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",n,!1),window.removeEventListener("load",n,!1)):(document.detachEvent("onreadystatechange",n),window.detachEvent("onload",n))}function t(){function s(n,t){var i=t?t:[];return $('div[data-size="'+n+'"]:not([data-loaded])').each(function(){var n=$(this),t={PageName:n.data("page"),ZoneName:n.data("zonename"),ZoneSize:n.data("size"),ZoneLangCode:n.data("lang"),IsSharedSite:n.data("shared-site"),IsContest:n.data("contest"),UserId:n.data("user")};i.push(t)}),i}function y(t){if(t.length!==0){var i=JSON.stringify(t);$.ajax({dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",url:"/en-us/cms/content",data:i,success:function(t){t&&$("div[data-page][data-zonename][data-size]").each(function(){var i=$(this),r=i.data("page"),u=i.data("zonename"),f=i.data("size"),e=i.data("lang"),o=i.data("user"),s=t.length;for(n=0;n<s;n++)t[n].PageName.toLowerCase()===r&&t[n].ZoneName.toLowerCase()===u&&t[n].ZoneSize.toLowerCase()===f&&t[n].ZoneLangCode.toLowerCase()===e&&(t[n].IsContest&&t[n].UserId==o?i.append('<div class="contest-item">'+t[n].ZoneContent+"<\/div>"):t[n].IsContest||(i.html(t[n].ZoneContent),t[n].FromPreview===!0&&i.attr("data-preview",!0)));i.attr("data-loaded",1);i.trigger("zoneloaded.cms",i)})}})}}for(var u=["xs","sm","md","lg"],h=u.length,c={},t,l,f,e,a,r,o,i,n=0;n<h;n++)t=u[n],l="windowSizeIdentifier-"+t,f=$("<div/>").attr("id",l).addClass("visible-"+t),c[t]=f,$("body").prepend(f);if(window.LoadNewZones=function(){var r="",i;for(n=0;n<h;n++)if(t=u[n],c[t].is(":visible")===!0){r=t;break}i=[];switch(r){case"xs":s("small",i);break;default:s("large",i)}s("any",i);i.length>0&&y(i)},e=null,$(window).resize(function(){clearTimeout(e);e=setTimeout(function(){LoadNewZones()},100)}),!1){a=/previewChangesetId=([^&;]+)/g;r=a.exec(document.location.search);r&&r.length>1&&(document.cookie="previewChangesetId="+r[1]+";path=/");function v(n){var t=document.cookie.match(new RegExp("(?:^|; )"+n.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):undefined}if(o=v("previewChangesetId"),o){$("head").append('<style>.showme { position: relative; } .showme:after { content: ""; display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(202, 198, 55, 0.5); } .zone_name { display: none; } .showme .zone_name { display:block; position: absolute; background: yellow; font-weight: bold; color: #000; font-size: 12px; padding: 3px 5px; z-index:1000; }<\/style>');$("body").prepend('<div id="cmsPreview" style="position:fixed; top:8px; right:10px; padding:5px 8px; width:200px; background-color:#ed9c28; z-index:99999999; color:white; cursor:move; opacity:.95; border-radius: 3px; text-shadow: 0 0 2px #626262"><span style="font-size: 15px; font-weight: bold; display: block; margin-bottom: 5px; border-bottom: 1px solid #fff"><i class="glyphicon glyphicon-eye-open"><\/i> Preview Mode<\/span>Changeset ID: #'+o+'<br><input type="checkbox" id="highlightChanges" style="margin-right: 5px; margin-top: 7px; height: 16px; width: 16px; float: left; cursor: pointer"/><label for="highlightChanges" style="font-weight: normal; cursor: pointer; margin-top: 5px;">Highlight Changes<\/label><br/><input type="checkbox" id="highlightAllZones" style="margin-right: 5px; margin-top: 2px; height: 16px; width: 16px; float: left; cursor: pointer"/><label for="highlightAllZones" style="font-weight: normal; cursor: pointer">Highlight All Zones<\/label><br/><a href="javascript:cmsExitPreview();" style="text-shadow: none; margin-top: 5px; color: #444; text-decoration: underline; font-size: 12px;">Exit Preview<\/a><\/div>');i=$("#cmsPreview");i.mousedown(function(n){var t=n.clientY-parseInt(i.position().top),r=n.clientX-parseInt(i.position().left);$(window).mousemove(function(n){i.css("top",n.clientY-t+"px").css("left",n.clientX-r+"px")})});$(window).mouseup(function(){$(this).off("mousemove")});i.on("change","#highlightChanges",function(){var n=$("[data-page][data-zonename][data-preview=true]");$(this).prop("checked")?(n.each(function(){$(this).css("box-shadow")!=="none"&&$(this).attr("data-box-shadow",$(this).css("box-shadow"))}),n.css("box-shadow","0px 0px 0px 4px yellow")):n.each(function(){$(this).attr("data-box-shadow")!==undefined?$(this).css("box-shadow",$(this).attr("data-box-shadow")):$(this).css("box-shadow","none")})});i.on("change","#highlightAllZones",function(){$("[data-zonename]").toggleClass("showme").each(function(){var n=$(this).data("page")+"_"+$(this).data("zonename");$(this).find(".zone_name").length<1&&$(this).prepend('<span class="zone_name">'+n+"<\/span>")})})}}LoadNewZones()}window.cmsExitPreview=function(){document.cookie="previewChangesetId=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;";$("#cmsPreview").remove();window.location.href=window.location.href.replace(/(\?|&)previewChangesetId=\d+/,"")};window.cmsInitialized=!0;i()}})()